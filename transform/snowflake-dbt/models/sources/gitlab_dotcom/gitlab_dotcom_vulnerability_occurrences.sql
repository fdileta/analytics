WITH source AS (

    SELECT *
    FROM {{ source('gitlab_dotcom', 'vulnerability_occurrences') }}
    
)
SELECT 
    created_at::TIMESTAMP                                                 AS vulnerability_created_at,
    name::VARCHAR                                                         AS vulnerability_name,
    report_type::NUMBER                                                      AS vulnerability_report_type,
    severity::NUMBER                                                         AS vulnerability_severity,
    SHA2(RANDSTR(32, project_id::NUMBER) || project_id::VARCHAR)::VARCHAR AS project_id
FROM source
